"3.8.2 (created: 2014/02/13 23:52:43)

set hintchars=abcdefghijklmnopqrstuvwxyz
source! /home/leo/.vimperatorrc.local
set gui=none
set editor=subl3
" vim: set ft=vimperator:

"set focuscontent
map Q :tabonly<CR>
colorscheme darkness
highlight Hint font-size:12px; color:white; background-color:black; padding:2px; text-transform:uppercase; border-radius:5px; border:1px solid white;

:inoremap <C-a> <Ins><C-a><Ins>
inoremap <ESC> <ESC> | :js content.document.querySelector(':focus') && window.setTimeout(function() { content.document.querySelector(':selected').blur() })<CR>

noremap <C-e> <C-u>
noremap gb <C-o>
noremap gs gf
noremap gf <C-i>

noremap I :js toggle_bottombar('on')<CR><Insert>
noremap ia :redmineOpenAllIssues<CR>
noremap ic :redmineSetIssueStatus 5<CR> | :redmineSetAssignee 4<CR> | :redmineSaveIssue<CR>
noremap ij :redmineSetIssueStatus 6<CR> | :redmineSetAssignee 4<CR> | :redmineSaveIssue<CR>
noremap ie :redmineSetIssueStatus 3<CR> | :redmineReturnIssue<CR> | :redmineShowComment<CR> | :redmineFocusComment<CR>
noremap it :redmineShowComment<CR> | :redmineFocusComment<CR>
noremap ir :redmineReplyIssue 5<CR>
noremap is :redmineSaveIssue<CR>
noremap iR :js content.location.href = content.location.href.replace(/\/projects\/(.*?)\/.*/, '/projects/$1/time_entries/report?utf8=✓&criteria[]=user&f[]=spent_on&op[spent_on]=>t-&v[spent_on][]=14&f[]=&c[]=project&c[]=spent_on&c[]=user&c[]=activity&c[]=issue&c[]=comments&c[]=hours&columns=day&criteria[]=')<CR>

noremap xR :source .vimperatorrc<CR>
noremap E :js toggle_bottombar('on')<CR> | :open http://rm.idfly.ru/projects/
noremap e :js toggle_bottombar('on')<CR> | :open http://rm.idfly.ru/issues/
noremap xt :open http://rm.idfly.ru/projects/todo-shagabutdinov-idfly-ru/issues?utf8=✓&set_filter=1&f[]=status_id&op[status_id]=o&f[]=tracker_id&op[tracker_id]==&v[tracker_id][]=5&f[]=assigned_to_id&op[assigned_to_id]==&v[assigned_to_id][]=me&f[]=&c[]=tracker&c[]=status&c[]=priority&c[]=subject&c[]=assigned_to&c[]=due_date&group_by=<CR>
noremap im :open http://rm.idfly.ru/issues?query_id=2<CR>
noremap il /На проверку<CR><CR>
noremap iq /В работе<CR><CR>

noremap <A-q> :tabprevious<CR>
noremap <A-w> :tabnext<CR>

inoremap <A-q> <ESC><ESC><ESC>:tabprevious<CR>
inoremap <A-w> <ESC><ESC><ESC>:tabnext<CR>

"silent qmark y http://youtube.com/

noremap xc :silent execute "!chromium \"" + content.location.href + "\" &"<CR>
noremap xs :js saveToPocket()<CR>
noremap xp :open http://getpocket.com/<CR>

set hto=300

"javascript to hide statusbar
noremap <silent> q :js toggle_bottombar()<CR>
noremap : :js toggle_bottombar('on')<CR>:
noremap o :js toggle_bottombar('on')<CR>o
noremap O :js toggle_bottombar('on')<CR>O
noremap t :js toggle_bottombar('on')<CR>t
noremap T :js toggle_bottombar('on')<CR>t
noremap y :js toggle_bottombar('on')<CR>y
noremap / :js toggle_bottombar('on')<CR>/
cnoremap <CR> <CR>:js toggle_bottombar('off')<CR>
cnoremap <Esc> <Esc>:js toggle_bottombar('off')<CR>

:js << EOF
function toggle_bottombar(p) {
    var bb = document.getElementById('liberator-bottombar');
    if (!bb)
        return;
    if (p == 'on'){
        bb.style.height = '';
        bb.style.overflow = '';
        return;
    }
    if (p == 'off'){
        bb.style.height = '0px';
        bb.style.overflow = 'hidden';
        return;
    }
    bb.style.height = (bb.style.height == '') ? '0px' : '';
    bb.style.overflow = (bb.style.height == '') ? '' : 'hidden';
}
EOF

js << EOF
function saveToPocket() {
    var e = function(t, n, r, i, s) {
        var o = [6161501, 5205852, 5940608, 3650441, 1158906, 9610544, 2068744, 2067432, 5676060, 2576344];
        var i = i || 0,
            u = 0,
            n = n || [],
            r = r || 0,
            s = s || 0;
        var a = {
            'a': 97,
            'b': 98,
            'c': 99,
            'd': 100,
            'e': 101,
            'f': 102,
            'g': 103,
            'h': 104,
            'i': 105,
            'j': 106,
            'k': 107,
            'l': 108,
            'm': 109,
            'n': 110,
            'o': 111,
            'p': 112,
            'q': 113,
            'r': 114,
            's': 115,
            't': 116,
            'u': 117,
            'v': 118,
            'w': 119,
            'x': 120,
            'y': 121,
            'z': 122,
            'A': 65,
            'B': 66,
            'C': 67,
            'D': 68,
            'E': 69,
            'F': 70,
            'G': 71,
            'H': 72,
            'I': 73,
            'J': 74,
            'K': 75,
            'L': 76,
            'M': 77,
            'N': 78,
            'O': 79,
            'P': 80,
            'Q': 81,
            'R': 82,
            'S': 83,
            'T': 84,
            'U': 85,
            'V': 86,
            'W': 87,
            'X': 88,
            'Y': 89,
            'Z': 90,
            '0': 48,
            '1': 49,
            '2': 50,
            '3': 51,
            '4': 52,
            '5': 53,
            '6': 54,
            '7': 55,
            '8': 56,
            '9': 57,
            '\/': 47,
            ':': 58,
            '?': 63,
            '=': 61,
            '-': 45,
            '_': 95,
            '&': 38,
            '$': 36,
            '!': 33,
            '.': 46
        };
        if (!s || s == 0) {
            t = o[0] + t
        }
        for (var f = 0; f < t.length; f++) {
            var l = function(e, t) {
                return a[e[t]] ? a[e[t]] : e.charCodeAt(t)
            }(t, f);
            if (!l * 1) l = 3;
            var c = l * (o[i] + l * o[u % o.length]);
            n[r] = (n[r] ? n[r] + c : c) + s + u;
            var p = c % (50 * 1);
            if (n[p]) {
                var d = n[r];
                n[r] = n[p];
                n[p] = d
            }
            u += c;
            r = r == 50 ? 0 : r + 1;
            i = i == o.length - 1 ? 0 : i + 1
        }
        if (s == 229) {
            var v = '';
            for (var f = 0; f < n.length; f++) {
                v += String.fromCharCode(n[f] % (25 * 1) + 97)
            }
            o = function() {};
            return v + '10799c1989'
        } else {
            return e(u + '', n, r, i, s + 1)
        }
    };
    var t =
        content.
        document,
        n = t.location.href,
        r = t.title;

    var i = e(n);
    var s = t.createElement('script');
    s.type = 'text/javascript';
    s.src = 'https://getpocket.com/b/r4.js?h=' + i + '&u=' + encodeURIComponent(n) + '&t=' + encodeURIComponent(r);
    e = i = function() {};
    var o = t.getElementsByTagName('head')[0] || t.documentElement;
    o.appendChild(s)
};
EOF
