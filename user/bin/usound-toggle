#!/usr/bin/env ruby

(0..5).each { |index|
  amixer = `amixer --card #{index}`
  if !amixer.include?("'Master'")
    next
  end

  command = 'mute'
  if amixer.match(/Playback[^\n]+\[(on|off)\]/)[1] == 'off'
    command = 'unmute'
    `pacmd set-sink-mute 0 0`
  else
    `pacmd set-sink-mute 0 1`
  end

  `amixer --card #{index} set Master #{command}`
  `amixer --card #{index} set Headphone #{command}`
  break
}

